---
title: "Graph 1"
author: "Jillian Anderson"
date: "April 10, 2016"
output: pdf_document
---

```{R setup, include=FALSE}
# Setting up the Data Set
library(foreign)
library(dplyr)
library(ggplot2)
library(igraph)
library(reshape2)
```

## Scatter Plot ISSP    

This graph uses data from the ISSP religion dataset we used for our first Data Challenge, which can be found at http://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA4950.   

This time I have chosen to compare nations' average "religious" score against the average "trusting" score. I found each of these scores by first converting survey responses to numeric values (ex Very Non-Religious->0, Very Religious->6, Least Trusting ->0, Most Trusting->4). Then I found the mean response for each country.   

When I plotted it I first found that people were much less trusting then I had anticipated. a nationâ€™s average self declared religiousness vs its trusting nature. I find it interesting that countries which tend to be more religious are also those which are least trusting.   

```{R, outer=TRUE, fig.width=8.5, fig.height=6}
issp <- read.dta("/Users/jilliananderson/Documents/University/3B/INTEG375/Deliverables/DV01/GESISReligion.dta")

isspgraph <- issp %>%
  select(V5, V63, V13) %>%
  # Renaming Variables
  rename(Country  = V5) %>%
  rename(religion = V63) %>%
  rename(trust = V13) %>%
  # Removing the country code in the form (__-). But Great Britain is a special case
  mutate(Country = substring (Country, 4)) %>%
  mutate(Country = gsub("GBN-Great Britain and/or United Kingdom", "Great Britain", Country)) %>%
  # Filtering out "Can't Choose" and "No Answer" as they skew results
  filter(religion!=0 & religion !="Can't Choose") %>%
  filter(trust !=0 & trust !="Can't Choose") %>%
  # Changing religious description as a scale 
  #0->6 = Extremely not religious->Extremely religious)
  mutate(religionnum = ifelse(religion == "Yes, Definitely", 1, religion)) %>%
  mutate(religionnum = abs(religionnum-7)) %>%
  # Changing answers to "religions bring more trust than peace" to a scale
  # 0->3 = No trust -> trust
  mutate(trustnum = ifelse(trust == "People can almost always be trusted", 1, trust)) %>%
  mutate(trustnum = abs(trustnum-4)) %>%
  # Finding the mean religious level and mean trust level for each country
  group_by(Country) %>%
  summarize(mean_religion = mean(religionnum), mean_trust = mean(trustnum))

plot <- ggplot(isspgraph, aes(x=mean_religion, y=mean_trust, labels=Country)) +
  geom_point(color="orange") + 
  geom_text(aes(label=Country), size=2, 
            hjust=-0.1, color = "grey30") +
  theme_minimal() + 
  # Adding Plot Title
  ggtitle("Religion vs Trusting") + 
  theme(plot.title = element_text(lineheight=0.8, face="bold", size = 18)) + 
  # Removing axis text and titles
  theme(axis.text.x = element_blank()) +
  scale_x_continuous(name ="") + 
  theme(axis.text.y = element_blank()) + 
  scale_y_continuous(name ="") + 
  # Adding arrows to the axis
  annotate("segment", x=1, xend=5, y=1.5, yend=1.5, 
           arrow=arrow(ends = "both", type="closed", length=unit(0.02,"npc")))+ 
  annotate("segment", x=3, xend=3, y=0.5, yend=2.5, 
           arrow=arrow(ends = "both", type="closed", length=unit(0.02,"npc"))) + 
  # Annotating axis ends
  annotate("text", x=5, y=1.5, label="Religious", 
           vjust=-0.5, hjust = 0.7, fontface="bold", size=4) + 
  annotate("text", x=1, y=1.5, label="Non-religious", 
           vjust=-0.5, hjust = 0.2, fontface="bold", size=4) + 
  annotate("text", x=3, y=0.5, label="Un-trusting", 
           vjust=1.5, fontface="bold", size=4) + 
  annotate("text", x=3, y=2.5, label="Trusting", 
           vjust=-0.5, fontface="bold", size=4) + 
  coord_cartesian(ylim=c(0.4,2.6))

ggsave("ISSP_Trust.png", device = "png", path = "/Users/jilliananderson/Documents/University/3B/INTEG375/Portfolio/ISSP")

```